{% extends "Base/dashboard.html" %}
{% load static %}
{% block head_content %}
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.9/index.global.min.js'></script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        var calendarEl = document.getElementById('calendar');
        var calendar = new FullCalendar.Calendar(calendarEl, {
            themeSystem: 'bootstrap5',
            initialView: 'timeGridWeek',
            firstDay: 1,
            // weekends: false, if weekends should be open or closed.
            headerToolbar: { center: 'dayGridMonth,timeGridWeek,timeGridDay,list,multiMonthYear', },
            views: {
                dayGridMonth: { // name of view
                    titleFormat: { year: 'numeric', month: 'short', day: 'numeric' }
                },
                timeGridWeek: {
                    titleFormat: { year: 'numeric', month: 'short', day: 'numeric' }
                }
            },
            events: [
                {
                    id: 'UUID1',
                    title  : 'event1',
                    start  : '2023-11-13T12:00:00',
                    end    : '2023-11-13T14:00:00',
                    allDay: false
                },
                {
                    id: 'UUID2',
                    title  : 'event2',
                    startRecur: '2023-11-13',
                    // endRecur: '2023-11-14',
                    startTime  : '13:00:00',
                    endTime    : '14:00:00',
                    daysOfWeek: [1,3,5], // Repeat frequency
                    allDay: false,
                    groupId: 'Series-group-id',
                },
                {
                    id: 'UUID3',
                    title  : 'event3',
                    start  : '2023-11-15T12:30:00',
                    start  : '2023-11-16T00:00:00',
                    allDay : true
                },
                {
                    id: 'UUID4',
                    start: '2023-11-24T00:00:00',
                    end: '2023-11-25T23:59:00',
                    display: 'background',
                    backgroundColor: '#900',
                    selectable: false,
                    classNames: "fc-unavailable",
                    title  : 'Unavailable',
                    description: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras eu pellentesque nibh. In nisl nulla, convallis ac nulla eget, pellentesque pellentesque magna.',
                },
            ],
            // eventClick: function(arg) { // confirm and delete event or event re-occurence
            //     // if (confirm('delete event?')) {
            //     //     arg.event.remove()
            //     // }
            //     console.log(arg.event)
            // },
            eventColor: '#7e0cf5',
            navLinks: true,
            navLinkDayClick: function(date, jsEvent) {
                // when a date is clicked
            },
            dateClick: function(info) {
                // console.log('clicked ' + info.dateStr, info.view);
                // console.log(info.view.calendar.currentData.options)
                const ve = calendar.getEventById('UUID4')
                // console.log( ve )
                const currEl = info.dayEl
                const business_day = currEl.querySelector(".fc-unavailable")
            
                if (business_day !== null && business_day !== undefined) {
                    console.log('true', business_day, currEl)
                } else {
                    console.log('false', currEl)
                }
            },
            selectable: true,
            select: function(info) {
                console.log('selected ' + info.startStr + ' to ' + info.endStr);
                // console.log(info)
            },
            unselectAuto: false,
            selectOverlap: true,
            nowIndicator: true,
            // now: // set from DB, per user's timezone and locale,
            // businessHours: {
            //     // days of week. an array of zero-based day of week integers (0=Sunday)
            //     daysOfWeek: [ 1, 2, 3, 4 ], // Monday - Thursday

            //     startTime: '10:00', // a start time (10am in this example)
            //     endTime: '18:00', // an end time (6pm in this example)
            // },
            // businessHours: [ // specify an array instead
            //     {
            //         daysOfWeek: [ 1, 2, 3 ], // Monday, Tuesday, Wednesday
            //         startTime: '08:00', // 8am
            //         endTime: '18:00' // 6pm
            //     },
            //     {
            //         daysOfWeek: [ 4, 5 ], // Thursday, Friday
            //         startTime: '10:00', // 10am
            //         endTime: '16:00' // 4pm
            //     }
            // ]
             // selectConstraint:  hasBusinessHours ? "businessHours" : null,
        });
        calendar.render();
      });
    </script>
{% endblock %}

{% block dashboard-main-content %}
<div class="row">
    <!-- <div class="col-md-4">
    </div> -->
    <div class="col-md-12">
        <div class="row">
            <div class="col-md-8">
                <div class="profile-header-section">
                    <h2>{{ user.name }}</h2>
                    <h6 class="mb-5">
                        {% if user.position is not None %}
                            {{ user.position }},
                        {% endif %}
                        {{ user.company }}
                    </h6>
                </div>
            </div>
            <div class="col-md-4">
                <!-- <div class="meetings">
                    <h4> Friday, 28th Janaury </h4>
                    <span>Next Meeting</span>
                </div> -->
            </div>
            <div class="col-md-12">
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Schedule</a>
                        </li>
                    </ul>
                    <div id='calendar'></div>
            </div>
        </div>
    </div>
</div>
{% endblock %}